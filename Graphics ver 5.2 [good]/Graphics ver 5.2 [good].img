( GRAPHICS VERSION 3     <10/16/84>140) EXIT                                                                            NUMBER OF COLORS AVAILABLE DEPENDS      ON COLORTAB; ESSENTIALLY UNLIMITED.                                             GRAPHICS MODES: ADDR X Y -- )                      DRAW CHARACTER AT [X,Y]              <GEMIT> ( CH -- )                          DRAW CHARACTER AT [GX,GY]                                           (  RLP )                                                                  cntd ) CR 210 211 THRU               ( gemit )                                         CR CR ." Graphics Package loaded"       CR 2BEEP QUIT                                                                                                                              WITHIN CURRENT X END POINTS          HPLOT ( X Y -- )                           PLOT POINT AT [X,Y]                     (DOES "SETENDPTS")                   LINE ( X1 Y1 X2 Y2 -- )                    DRAW LINE FROM [X1,Y1] TO [X2,Y2]    CDRAW (            ( colortab ) CR 162 165 THRU              ( hcolor ) CR 167 178 THRU               ( hline ) CR 180 181 THRU            ( vline fs ) CR 185 187 THRU           ( scup scdn ) CR 190 196 THRU           ( char draw )    198 204 THRU      ( char draw2 -- )                     SET CURRENT X END POINTS             HLINE ( Y -- )                             DRAW HORIZ LINE WITHIN CURRENT          X END POINTS                         VLINE ( Y1 Y2 -- )                         DRAW VERTICAL LINE (OR BAR)  ( SCARSDALE LOAD BLOCK   < 2/24/85>143) CR ." LOADING FOR SCARSDALE"            CR                                      \  149 149 THRU   ( HIDDEN vocabulary ) CR 150 150 THRU     ( zero-page usage )    151 155 THRU        ( yaddr, 7/mod ) CR 156 160 THRU ( HIGH-LEVEL WORDS       <10/12/84>141) --> EXIT                                HCOLOR ( N -- )                            SET CURRENT COLOR                    SETMODE ( N -- )                           SET GRAPHICS MODE; SEE SCR 140       SETENDPTS ( X1 X                                                                                                                                                                                       (  RLP )                                                                                                 V.4 : PATBUF REDUCED TO 40 BYTES,       FROM 320; CHARBUF MAPPED ONTO PATBUF;   PATTERN EXPANDED LINE BY LINE,          AS NEEDED.                     (  RLP )                                                                  "      CR ." 144 LOAD ( FOR BRODY ) "          CR CR                                                                           5 ' WIDTH !                                                                     QUIT                                                                                            HPLOT WILL WRAP AROUND IF PLOTTING AT   X = 279.                                                                        ADDRESS OF ASCII TABLE IS FOUND         IN CONSTANT ">ASCTAB".                          1985 BY "                  ." PRENTICE ASSOCIATES, INC. "       CR                                      CR ." SEE NOTES ON SCREENS "               ." 140 AND 141 "                     CR                                      CR ." 143 LOAD ( FOR SCARSDALE )                        0 = INVERT BITS ON SCREEN               1 = SET BITS                            2 = CLEAR BITS                          3 = INVERSE PATTERN TO SCREEN           4 = EOR PATTERN WITH SCREEN             5 = PUT PATTERN ON SCREEN       ( LOAD BLOCK             < 2/25/85>142) PAGE                                    CR ." APPLE GRAPHICS VERSION 5.2 "      CR ." MODIFIED FOR PAI FORTH "             ." 2/25/85 "                         CR ." ROBERT L. PYRON "                 CR ." (C) 1984,                                                                                                                                                                                        (  RLP )                                                                 ( BRODY LOAD BLOCK       < 2/25/85>144) CR ." LOADING FOR BRODY "               CR                                      \  149 149 THRU   ( HIDDEN vocabulary ) CR 150 150 THRU     ( zero-page usage )    151 155 THRU        ( yaddr, 7/mod ) CR 156 160 THRU                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  QUIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cntd ) CR 210 219 THRU ( gemit, gexpect, etc.)    220 225 THRU  ( xemit, xkey, gtype ) \  230 242 THRU          ( hplot line )                                                                                 CR CR ." Graphics Package loaded"       CR 2BEEP                                                                                                                                                                                                                                                                           ( colortab ) CR 162 165 THRU              ( hcolor ) CR 167 178 THRU               ( hline ) CR 180 182 THRU        ( vline fs bar ) CR 185 187 THRU           ( scup scdn ) CR 190 196 THRU           ( char draw )    198 204 THRU      ( char draw                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                EDIATE                                                                                                          MAIN EXIT                                                              (  RLP )                                                                 L,                   GBASE ROR,                              GBASE 1+ LDA, # 1F AND,                 # 20 ORA, GBASE 1+ STA,       PLA, RTS, XC;                                                                DECIMAL EXIT                            --------                                                : H'   ( look for word in HIDDEN voc. )    CONTEXT @ >R    ( save search voc. )    [COMPILE] HIDDEN  ( search HIDDEN )     [COMPILE] X'       ( find the word )    R> CONTEXT !      ( restore search )    ; IMM0  AND, GBASE STA,                   .A LSR, .A LSR,                         GBASE ORA, GBASE STA,              TXA, GBASE 1+ STA, .A ASL,                   .A ASL, .A ASL,                         GBASE 1+ ROL, .A ASL,                   GBASE 1+ ROL, .A AS                        APPENDIX                                                                        : .VOC                                     CURRENT @ NFA ID.                       CONTEXT @ NFA ID.                       CR ;                         ( $YADDR SUBROUTINE      < 2/25/85>151) \ entry: line# in X reg.                \ exit:  address in GBASE               \ all registers are preserved           HEX                                     XCODE $YADDR                               PHA, TXA, # C( HIDDEN                 < 2/24/85>149) MAIN                                                                            VOCABULARY HIDDEN IMMEDIATE                                                     FORTH DEFINITIONS                                       hics scratch area.              Note that D0 is just above the bottom   of the Forth data stack.                                                                                       (  RLP )                                                                                                                                                                                                                                                                                                                                         --------------------------------------- Locations D0 through EF are not used    by MVP-PADS, to allow use of the        Applesoft ram floating-point and        graphics routines.                      These particular loactions are part of  the grap                                                                                                                                                                                                                                                                                          VARIABLE GMODE 5 GMODE !                                                        E8 XCONST   &QUO       ( x offset )     EA XCONST   &REM       ( bit num. )                                           DECIMAL EXIT                                                                                                                                                                                                                                                                                    ( ZERO PAGE USAGE        < 2/25/85>150) HEX                                                                               E0 CONSTANT GBASE      ( >Y address )   E2 CONSTANT GPATTERN   ( >pattern   )   E4 CONSTANT GFIG       ( >fig data  )                 ------------------------------- Note: only valid for 0 <= line# <= 191  BOMBS FORTH when -1 or 255                                                                                     (  RLP )                                                                 ( YADDR code version     < 2/24/85>152)                                         CODE YADDR ( y -- yaddr )                    XSAVE STX, BOT LDA, TAX,                X' $YADDR JSR,                          XSAVE LDX,                              GBASE    LD                                                                                                                                                                                       (  RLP )                                                                               X' $B/MOD JSR,                          XSAVE LDX,                              # 0 LDY,                                &QUO LDA, BOT STA, BOT 1+ STY,          &REM LDA, SEC STA, SEC 1+ STY,          NEXT JMP, C;                                             1F C, 3F C, 7F C, FF C,                                                  DECIMAL EXIT                                                                                                                                                            RTS, XC;                                                                                                CODE B/MOD ( 16bit 8bit -- 8bit 8bit )        XSAVE STX,                              SEC LDA, SEC 1+ LDY,                    PHA, BOT LDA, TAX, PLA,                           XCREATE LMASKS                                 7F C, 7E C, 7C C, 78 C,                 70 C, 60 C, 40 C, 00 C,                                                  XCREATE RMASKS                                 01 C, 03 C, 07 C, 0F C,  ( $7/MOD 7/MOD B/MOD     < 2/24/85>155)                                         XCODE $7/MOD                                  N STA, TXA, PHA,                        N LDA, # 7 LDX,                         X' $B/MOD JSR,                          PLA, TAX, ( BIT MASK TABLES        < 2/24/85>153) HEX                                                                             CREATE BITTBL                                   1 C,  2 C,  4 C,  8 C,                 10 C, 20 C, 40 C, 80 C,                                                          EXIT                                                                                                                                                   (  RLP )                                                                                                                                                                                                                                                        (  RLP )                                                                                     N CMP,                        CS IF,    N SBC,                                  &QUO INC,                     THEN,     DEY,                         0= UNTIL,  &REM STA,                               PLA, TAY, PLA, RTS, XC;                                                              INPUT Y                                 Y1 = INT(Y /8) : YR = Y  - Y1*8         Y2 = INT(Y1/8) : YS = Y1 - Y2*8         L  = 8192 + 40*Y2 + 128*YS + 1024*YR                                                                           XCODE $B/MOD N STX, ( divisor )                     &QUO STA, ( dividend lsb )              PHA, TYA, PHA, ( " msb )                # 8 LDY,                     BEGIN,     &QUO ASL,                               .A ROL,             A, BOT    STA,               GBASE 1+ LDA, BOT 1+ STA,               NEXT JMP, C;                                                               EXIT                                    --------------------------------------- Algorithm in Basic:             ( $B/MOD unsigned divide < 2/25/85>154) \ 16bit/8bit --> 8bit,8bit              \ entry:                                \   "A" = lsb, "Y" = msb, "X" = divisor \ exit:                                 \   quotient in &QUO, remainder in &REM                                                 EXIT                                                                                                                                                                                                                            ( COLORTAB notes         <11/13/84>156)                                         EXIT                                    --------------------------------------- Each entry in COLORTAB is a nine-byte   block.                                  The first eight FF , FFFF , FFFF , FFFF , FF C,                                         DECIMAL EXIT                                                                                                   (  RLP )                                                                 , FF C, ( 23) AFAF , AFAF , FAFA , FAFA , FF C,                                         \ vertical bars for Sally               ( 24) A8A8 , A8A8 , A8A8 , A8A8 , FF C,                                         DECIMAL                                                       0000 , 0000 , 0000 , 0000 , FF C, \ 5=blue                                      5555 , 5555 , 5555 , 5555 , FF C, \ 6=orange                                    AAAA , AAAA , AAAA , AAAA , FF C, \ 7=white2                                    FFC , 33CC , 33CC , FF C, ( 19) 9966 , 9966 , 9966 , 9966 , FF C,                                         \ checks: white & xxx                   ( 20) 5F5F , 5F5F , F5F5 , F5F5 , 00 C, ( 21) AFAF , AFAF , FAFA , FAFA , 00 C, ( 22) 5F5F , 5F5F , F5F5 , F5F5                               5555 , 5555 , 5555 , 5555 , 00 C, \ 2=green                                     AAAA , AAAA , AAAA , AAAA , 00 C, \ 3=white1                                    FFFF , FFFF , FFFF , FFFF , 00 C, \ 4=black2                      ( COLORTAB CONTINUED     < 2/25/85>159) HEX                                                                             \ four colors of gray                   ( 16) 33CC , 33CC , 33CC , 33CC , 00 C, ( 17) 9966 , 9966 , 9966 , 9966 , 00 C, ( 18) 33CC , 33C( COLORTAB               < 2/24/85>157) HEX \ solid colors                      CREATE COLORTAB                                                                 \ 0=black1                                    0000 , 0000 , 0000 , 0000 , 00 C, \ 1=violet      EXIT                                                                                                                                                                                   (  RLP )                                                                                                                                                                                                                                                        (  rlp )                                                                 , FF C, \ blue & white                          ( 13) DD77 , DD77 , DD77 , DD77 , FF C, \ orange & black                        ( 14) 8822 , 8822 , 8822 , 8822 , FF C, \ orange & white                        ( 15) BBEE , BBEE , BBEE , BBEE , FF C, DECIMAL                                                                                                                                                                                                                                                                 7 , DD77 , DD77 , 00 C, \ green & black                         ( 10) 8822 , 8822 , 8822 , 8822 , 00 C, \ green & white                         ( 11) BBEE , BBEE , BBEE , BBEE , 00 C, \ blue & black                          ( 12) 1144 , 1144 , 1144 , 1144 bytes form an 8-by-8    bit array that is expanded into         eight full scan lines.                  The ninth byte indicates whether the    color bit is turned on for each scan    line.                                                                   ( COLORTAB CONTINUED     < 2/24/85>158) HEX                                     \ 8-15  small dot patterns              \ violet & black                        ( 8 ) 1144 , 1144 , 1144 , 1144 , 00 C, \ violet & white                        ( 9 ) DD77 , DD7                                EXIT                                                                                                                                                   ( SAP  )                                                                 ( COLORTAB CONTINUED     <11/13/84>160)                                         EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        TEMPLATE 8 + LDA,                       BITTBL ,X AND,               0= NOT IF, # 128 LDA,                   THEN,      N 1+  STA,                                                          EXIT ( m                                                                                                                                                                                                                                                                                                    # 7 AND, TAX,                                                                   ' PATBUF LDA,                           GPATTERN STA,                           ' PATBUF 1+ LDA,                        GPATTERN 1+ STA,                                                                                                                                                                                                                                                                    ( $>PATBUF               < 2/24/85>163) ( ALL REGISTERS PRESERVED )                                                                                             XCODE $>PATBUF                                      PHA, TYA, PHA, TXA, PHA,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      XVAR LEFT.D7     0 LEFT.D7 !            XVAR LEFT.MSK    0 LEFT.MSK !           XVAR RIGHT.D7    0 RIGHT.D7 !           XVAR RIGHT.MSK   0 RIGHT.MSK !                                                                                                                                                                                                                                                                                                        ( $SETPATTERN VARS       < 2/24/85>162)                                         \ 16384 CONSTANT PATBUF                          ( 42-byte buffer )                                                       CREATE TEMPLATE   9 ALLOT                             ore ... )                                                                                                                                                                                                                                                       ( $>PATBUF continued     < 2/24/85>164)                                                     TEMPLATE ,X LDA,                        # 39 LDY,                     BEGIN,    X' RIGHT.D7 CPY,              0= NOT WHILE,                                     PHA,                                                                                                                                                                                       (  RLP )                                                                           0= UNTIL,    X' LEFT.MSK LDA,                        X' $INVERTB JMP, XC;                                             EXIT                                                                                                                                                                            EXIT                                                                                                                                                                                                                                    XCODE $INVERT                             BEGIN,       GBASE )Y EOR,                           GBASE )Y STA,                           # 127 LDA,                              DEY,                                    X' LEFT.D7 CPY,                          : HCOLOR ( N -- )                                DUP COLOR# !                            9 * COLORTAB +                          SETPAT ;                                                               : SETMODE  ( N -- ) GMODE ! ;   ( $INVERT SUBROUTINE     < 2/24/85>167)                                         XCODE $INVERTB                                         GBASE )Y EOR,                           GBASE )Y STA,                           RTS, XC;                                 ( SETPAT SETCOLOR        < 2/24/85>165)                                         VARIABLE COLOR#                                                                 : SETPAT ( ADDR -- )                             TEMPLATE 9 CMOVE ;                                                                                                                                                                                                                                                                                                 RTS, XC;                                                            EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                        PLA, .A ROR,                            X' LEFT.D7 CPY,               0= NOT WHILE,                                     DEY,                          REPEAT,                                           PLA, TAX, PLA, TAY, PLA,                                                                                                                                                                                                                                                                             .A LSR,                            PLA, .A ROR,                            DEY,                          REPEAT,                                 BEGIN,    PHA, .A LSR,                            N 1+ ORA,                               PATBUF ,Y STA,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ( $TURNON SUBROUTINE     < 2/24/85>168)                                         XCODE $TURNONB                                         GBASE )Y ORA,                           GBASE )Y STA,                           RTS, XC;                                                                                                                                                                                                                                                                                                           BEGIN,        GBASE )Y AND,                           GBASE )Y STA,                           DEY,                                    LEFT.D7 CPY,              0= NOT WHILE, GPATTERN )Y LDA,          REPEAT,       LEFT.MSK LDA,                                          DEY,                                    X' LEFT.D7 CPY,            0= UNTIL,    X' LEFT.MSK LDA,                        X' $TURNOFFB- JMP, XC;                                           EXIT                                            GBASE )Y AND,                           GBASE )Y STA,                           RTS,                    END-CODE                                                                        CODE $ANDPAT                                            GPATTERN )Y AND,TS, XC;                                                         XCODE $TURNOFF-                                        # 255 EOR,                              GBASE )Y AND,              BEGIN,       GBASE )Y STA,                           # 0 LDA,         ( $ANDPAT SUBROUTINE     < 2/24/85>171) EXIT                                    \ probably doesn't work                 --------------------------------------  CODE $ANDPATB                                           GPATTERN )Y AND,                        ( $TURNOFF SUBROUTINE    < 2/24/85>169)                                         XCODE $TURNOFFB-                                       # 255 EOR,                              GBASE )Y AND,                           GBASE )Y STA,                           R       X' $INVPATTB- JMP, XC;                                           EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                    ,        BEGIN,        DEY,                                    X' LEFT.D7 CPY,           0= NOT WHILE, GPATTERN )Y LDA,                        # 127 EOR,                              GBASE )Y STA,             REPEAT,       X' LEFT.MSK LDA,                           0= UNTIL,    X' LEFT.MSK LDA,                        X' $TURNONB JMP, XC;                                             EXIT                                                                                                                             127 EOR,                              N AND, N 1+ ORA,                        GBASE )Y STA,                           RTS, XC;                                                         XCODE $INVPATT-                                        X' $INVPATTB- JSR                        XCODE $TURNON                                          GBASE )Y ORA,              BEGIN,       GBASE )Y STA,                           # 127 LDA,                              DEY,                                    X' LEFT.D7  CPY, ( $INVPAT SUBROUTINE     < 2/24/85>170) XCODE $INVPATTB-                                       # 128 ORA, N STA,                       # 255 EOR, GBASE )Y AND,                N 1+ STA,                               GPATTERN )Y LDA,                        #        ' $ANDPATB JMP,         END-CODE                                                                                                                                               (  RLP )                                                                 ( $EORPAT SUBROUTINE     < 2/24/85>172)                                         XCODE $EORPATB                                          # 128 ORA,                              GPATTERN )Y AND,                        GBASE )Y EOR,                                                           EXIT                                                                                                                                                                                                                                        0= IF,   X' $INVPATT- JMP,              THEN,    N DEC,                         0= IF,   X' $EORPAT   JMP,              THEN,                                            X' $FILLPAT  JMP, XC;                                              EXIT    ,         BEGIN,        DEY,                                    X' LEFT.D7 CPY,           0= NOT WHILE, GPATTERN )Y LDA,                        GBASE )Y STA,             REPEAT,       X' LEFT.MSK LDA,                        X' $FILLPATB JMP, XC;           EC,                         0= IF,   X' $INVERT   JMP,              THEN,    N DEC,                         0= IF,   X' $TURNON   JMP,              THEN,    N DEC,                         0= IF,   X' $TURNOFF- JMP,              THEN,    N DEC,             N AND,                                  GBASE )Y EOR,                           GBASE )Y STA,                           RTS, XC;                                                        XCODE $FILLPAT                                          X' $FILLPATB JSR( $C-HLINE               < 2/24/85>175)                                         XCODE $C-HLINE                                       PHA,                                    GMODE LDA, N STA, N INC,                PLA,                                    N D( FILLPAT                < 2/24/85>173)                                         XCODE $FILLPATB  # 128 ORA,                             N STA,                                  GBASE )Y LDA,                           GPATTERN )Y EOR,                                                                                                                                                                                                                                                                                                                        EXIT                                                                                                                                                                                                                                        0= IF,   X' $INVPATTB- JMP,             THEN,    N DEC,                         0= IF,   X' $EORPATB  JMP,              THEN,                                            X' $FILLPATB JMP, XC;                                              EXIT                            GBASE )Y STA,                           DEY,                                    X' LEFT.D7 CPY,           0= NOT WHILE, GPATTERN )Y LDA,          REPEAT,       X' LEFT.MSK LDA,                        X' $EORPATB JMP, XC;            EC,                         0= IF,   X' $INVERTB  JMP,              THEN,    N DEC,                         0= IF,   X' $TURNONB  JMP,              THEN,    N DEC,                         0= IF,   X' $TURNOFFB- JMP,             THEN,    N DEC,             GBASE )Y STA,                           RTS, XC;                                                        XCODE $EORPAT                                           # 128 ORA,                              GPATTERN )Y AND,          BEGIN,        GBASE )Y EOR,   ( $D-HLINE               < 2/24/85>174)                                         XCODE $D-HLINE                                       PHA,                                    GMODE LDA, N STA, N INC,                PLA,                                    N D                                                                                                                                                                                                                                                                ( $HLINEB $HLINE         < 2/24/85>176)                                         XCODE $HLINEB                             # 192 CPX, CS IF, RTS, THEN,            X' RIGHT.MSK LDA,                       X' RIGHT.D7 LDY,                        # 40 CPY, CS I $YADDR JSR,                          X' $HLINEB JSR,                         PLA, TAX, POP JMP, C;                                                     EXIT                           (  RLP )                                                                                                                                                                                                                                                                                                                                         \  when pattern address                 \  {GPATTERN} has been                  \  previously computed                                                          CODE HLINEB ( y -- )                          TXA, PHA, BOT LDA, TAX,                 X'                                                                                                                                                                                                                                                                - )                           XSAVE STX, BOT LDA, TAX,                X' $HLINE JSR,                          XSAVE LDX, POP JMP, C;                                                    \ HLINEB :                              \  draw horizontal line                                                                                                                                                                                                                                                                         ( HLINEB  HLINE          < 2/24/85>177) \ HLINE :                               \  draw horizontal line                 \  within current end points            \  "X" = y line #                                                               CODE HLINE ( y -                                                                                                                                                                                       (  RLP )                                                                                                                                                                                                                                                                                                                                         0 279 SETENDPTS                                                                 EXIT                                                                                                                                                                            XCODE $HLINE                                     # 192 CPX, CS IF, RTS, THEN,            X' $>PATBUF JSR,                        X' $YADDR JSR,                          X' $HLINEB JMP, XC;                                                    EXIT    RIGHT.D7 !                    RMASKS + C@ X' RIGHT.MSK !                                                      0 MAX 279 MIN                           7 /MOD X' LEFT.D7 !                     LMASKS + C@ X' LEFT.MSK ! ;                                       F, RTS, THEN,             X' LEFT.D7 CPY, CS NOT IF, RTS, THEN,   0= IF, X' LEFT.MSK  AND,                       X' $D-HLINE JMP,                 ELSE,  X' $C-HLINE JMP,                 THEN,  XC;                                                            ( SETENDPTS              < 2/24/85>178)                                         : SETENDPTS ( X1 X2 -- )                      DDUP > IF SWAP THEN                                                             0 MAX 279 MIN                           7 /MOD X'                                                                                                                                                                                                                                                                 ( VLINE                  < 2/25/85>180)   XVAR VY1   XVAR VY2                                                             XCODE $VLINE  TXA, PHA,                              X' VY1 LDX,                  BEGIN,     X' $HLINE JSR,                          X                                                                                                                                                                                       ( SAP  )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 NDPTS                         0 191 VLINE ;                                                             : FS ( n -- ) HCOLOR <FS> ;                                                     EXIT                                                                                                                                                                                                                                                                                                                                    ( <FS> FS                < 2/25/85>181)                                         \ fill screen with color                                                        : <FS>                                        FORGET-SYS                              0 279 SETE                                                                                                                                                                                       (  RLP )                                                                                                 EXIT                                                                                                                                                   (  RLP )                                                                                       ELSE OVER + 1-                     THEN VBAR                         THEN ;                                                                       EXIT                                                                                    s                                               : VLINE ( y1 y2 -- )                       DDUP > IF SWAP THEN                     0 MAX 191 MIN X' VY2 !                  0 MAX 191 MIN X' VY1 !                  X' $VLINE CALL ;                             DROP                       ELSE  ROT >R >R SWAP ( x w | y h )            DUP 0< IF OVER + 1+                          ELSE OVER + 1-                     THEN SETENDPTS                          R> R>                                   DUP 0< IF OVER + 1+    ' VY2 CPX,                    CS NOT                                  WHILE,   INX,                         REPEAT,    PLA, TAX, RTS, XC;                                               \ VLINE draw vertical line/bar          \       within current end point( VBAR BAR               < 2/25/85>182)                                         : VBAR VLINE ;                                                                  : BAR ( width height x y -- )              DOVER 0= SWAP 0= OR                     IF    DDROP D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (  RLP )                                                                                                                 EXIT                                                                                                                                                                                                            adr )      DUP 3 + C@ SWAP DROP ( t b l w )        OVER + RIGHT.D7 C! LEFT.D7 C!           127 LEFT.MSK C! 127 RIGHT.MSK C! ;                                                                                                                                   VER 1- SWAP                   DO    I YADDR GPATTERN !                      I YDELTA + HLINEB                 -1 +LOOP                             2 SETMODE ( black )                        DUP YDELTA + VLINE                   R> SETMODE ;                                         10 CONSTANT YDELTA                                                              : SCRL-PARM ( addr -- top bot )            DUP     C@ SWAP      ( t adr )          DUP 1+  C@ SWAP      ( t b adr )        DUP 2+  C@ SWAP      ( t b l ( SCDN                   < 2/24/85>187)                                         : SCDN ( win -- )                          SCRL-PARM ( top bottom )                GMODE C@ >R                             5 SETMODE                                  YDELTA - O( SCRL-PARM              < 2/24/85>185)                                         \ scroll points to 4-byte block         \ top bottom left(byt) width(byt)                                               \ CREATE WIN 00 C, 141 C,  2 C, 30 C,                                                                                                                                                                                                          (  RLP )                                                                                                                                                                                                                                                                                                                                                                                 EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                             YDELTA +                     DO    I YADDR GPATTERN !                      I YDELTA - HLINEB                 LOOP                                 2 SETMODE ( black )                        DUP 1+ YDELTA - SWAP VLINE           R> SETMODE ;                                                                                                                                                                                                                                                                                 ( SCUP                   < 2/24/85>186)                                         : SCUP ( win -- )                          SCRL-PARM ( top bottom )                GMODE C@ >R                             5 SETMODE                                  DUP 1+ ROT                                                                                                                                                                                       (  RLP )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  )       XVAR CPIX  ( pixel offset (draw )                                               XVAR C.RGT.D7                           XVAR C.RGT.MSK                         EXIT                                    --------------------------------------- CDELX an                                                                                                                                                                                                                                                                                         XVAR CHADDR ( addr of char data )       XVAR CHX          ( x draw pos. )       XVAR CHY          ( y draw pos. )       XVAR CBITS ( char width in bits )       XVAR CBYTES    ( width in bytes )       XVAR CHGT     ( height in lines                                                                                                                                                                                                                                                                ( CDRAW                  < 2/25/85>191)                                          2 CONSTANT CDELX   ( space between  )   2 CONSTANT CDELY   ( letters        )                                          PATBUF CONSTANT CHARBUF                                                                                                                                                                                                                                                                                                  a byte boundary                                                        Usage:   <addr> <xpos> <ypos> CDRAW                                                                            (  RLP )                                                                                                                                                                                                                                                                                                                                                                                  1 byte  Width in bits                   1 byte  Height in scan lines            N bytes character data;                         each scan line is                       left-justified on                                                                                                                                                                                                                                                                                                              --------------------------------------- V.2 character draw                            character is surrounded                 on all sides by 1-bit boundary                                            Character Format:                                                                                                                                                                                                                                                                               ( V.2 CHARACTER DRAW     < 2/25/85>190)                                         WIDTH 5 MAX ' WIDTH !                                                           : CTASK ;                                                                       EXIT            d CDELY are used by <GEMIT>                                                                                                                                                            (  RLP )                                                                 ( $CSHIFT                < 2/25/85>192) XCODE $CSHIFT   TXA, PHA, TYA, PHA,                    X' CPIX LDX, INX,         BEGIN,        DEX,                      0< NOT WHILE, X' LEFT.D7 LDY,                         DEY, CLC, PHP,             BEGIN,       Iore ... )                                                                                                                                                                              (  RLP )                                                                                        PLA, TAY,                               RTS, XC;                                                         EXIT                                                                                                                            , CLC,                    X' CBYTES ADC,                          X' C.RGT.D7 CMP,        CS IF,          X' C.RGT.D7 LDY,        ELSE,           TAY,                    THEN,                                                                         EXIT ( mBASE )Y LDA,                           # 128 AND,                              CHARBUF ,Y STA,                         X' LEFT.D7 CPY,           0= NOT WHILE, DEY,                      REPEAT,                                               X' $HLINEB JSR,    # 39 LDY,               BEGIN,          GBASE )Y LDA,                           # 128 AND,                              CHARBUF ,Y STA,                         X' C.RGT.D7 CPY,        0= NOT WHILE,   DEY,                    REPEAT,         X' LEFT.D7 LDA( $CLRLIN                < 2/25/85>195)                                         XCODE $CLRLIN                                          TYA, PHA,                               X' $YADDR JSR,                          X' RIGHT.D7 LDY,          BEGIN,        G( $CHLIN                 < 2/25/85>193)                                         XCODE $CHLIN                                              TYA, PHA,                               X' $YADDR JSR,                          GMODE LDA, # 3 CMP,    CS IF,                                         EXIT                                                                                                                                                   (  RLP )                                                                        PLA, TAY, PLA, TAX,                     RTS, XC;                 EXIT                                                                                                           (  RLP )                                                                                           GFIG STA,                CS IF,         GFIG 1+ INC,             THEN,                                 THEN,                                                    X' $HLINEB JSR,                         PLA, TAY, RTS, XC;                                   PLA, .A ASL, PHP,                       X' C.RGT.D7 CPY,           0= UNTIL,    PLP,                      REPEAT,   X' C.RGT.MSK LDA, # 128 ORA,                CHARBUF ,Y AND,                         CHARBUF ,Y STA,                    X' LEFT.D7 CPY,         0= NOT WHILE,   DEY,                    REPEAT,                                                 X' $CSHIFT JSR,                                                                 X' CBYTES LDA, CLC,                     GFIG ADC,     NY,                                    CHARBUF ,Y LDA,                         PLP, .A ROL, PHA,                       # 127 AND, N STA,                       GBASE )Y LDA,                           # 128 AND, N ORA,                       CHARBUF ,Y STA,  ( $CHLIN cont'd          < 2/25/85>194)                                         ( continued )                                                                     BEGIN,          GFIG )Y LDA,                            CHARBUF ,Y STA,                                                                                                                                                                                                              (  RLP )                                                                 ( $CDRAW                 < 2/25/85>196)                                         XCODE $CDRAW       TXA, PHA, TYA, PHA,                    ' CDELY LDA,            0< NOT IF,                                0= NOT IF,    X' CHY LDX,                                                                                                                                                                                                                                                                                                               N )Y LDA, X' CBITS STA,                 INY,                                    N )Y LDA, X' CHGT STA,                                                          INX, INX,                                                           EXIT ( 4                                                                                                                                                                                                                                                                                                    BOT LDA, N STA,                            CLC, # 2 ADC,                           X' &GFIG STA,                        BOT 1+ LDA, N 1+ STA,                      # 0 ADC,                                X' &GFIG 1+ STA,                                                                                                                                                                                                                                                                 ( CD-INIT continued      < 2/25/85>199) \ 1 screen preceding                                                                        # 0 LDY,                                X' CBITS 1+ STY,                        X' CHGT 1+ STY,                                                                                                                                                                                                                                                                                                    BOT 1+ LDA,                             X' CHX 1+ STA,            THEN, THEN,   INX, INX,                EXIT ( 5 more screens )                                                (  RLP )                                                                           RTS, XC;                                                      EXIT                                                                                                           (  RLP )                                                                 1+ STY,  ELSE,         # 1 CMP,                    CS IF,      BOT LDA, # 24 CMP,          THEN,                                   CS IF,      # 1 LDA, X' CHX 1+ STA,                 # 23 LDA, X' CHX STA,       ELSE,       BOT LDA, X' CHX STA,                                       INX,                    REPEAT,                                                 ' CDELY LDA,            0< NOT IF,      # 2 CMP,                  CS IF,        X' $CLRLIN JSR,         THEN, THEN,     PLA, TAY, PLA, TAX,           YA,                      ELSE,         BOT LDA, # 192 CMP,        CS IF,       # 192 LDA,                THEN, THEN, X' CHY STA, X' CHY 1+ STY,                INX, INX,                               BOT 1+ LDA,               0< IF,      X' CHX STY, X' CHX   X' $CLRLIN JSR,                         INX,                    THEN, THEN,                                             X' CHGT LDY, INY,       BEGIN,          DEY,                    0= NOT WHILE,                                           X' $CHLIN JSR,( CD-INIT                < 2/25/85>198)    XVAR &GFIG   XVAR &FOO                                                       CODE CD-INIT ( addr x y -- addr )                      # 0 LDY,                                BOT 1+ LDA,               0= NOT IF,    T more screens )                                                                                                                                                                        (  RLP )                                                                 ( CD-INIT continued      < 2/25/85>200) \ 2 screens preceding                                                                    XSAVE STX,                              X' CHX LDA, X' CHX 1+ LDY,                 # 7 LDX,                                X' $    XSAVE LDX,                                                          EXIT --> ( 2 more screens )                                                                                    (  RLP )                                                                 G STA,              X' &GFIG 1+ LDA, # 0 SBC,                  GFIG 1+ STA,                         ' CHARBUF LDA,                             GPATTERN STA,                        ' CHARBUF 1+ LDA,                          GPATTERN 1+ STA,                  LDY,    THEN,      # 7 LDX,                                X' $B/MOD JSR,                          &QUO LDA, X' C.RGT.D7 STA,              &REM LDY,                                  RMASKS ,Y LDA,                          X' C.RGT.MSK STA,                LDY,                     ELSE,      # 0 LDY,                     THEN,      # 7 LDX,                                X' $B/MOD JSR,                          &QUO LDA, X' CBYTES STA,                SEC, X' &GFIG LDA,                       X' LEFT.D7 SBC, GFI' &FOO STA,                         X' CHX 1+ LDA, # 0 ADC,                    X' &FOO 1+ STA,                      # 1 CMP,                     CS IF,  X' &FOO LDA, # 24 CMP, THEN,    CS IF,     # 23 LDA, # 1 LDY,           ELSE,   X' &FOO LDA, X' &FOO 1+( CD-INIT finally done!  < 2/25/85>203) \ 5 screens preceding                                                                       XSAVE STX,                              X' CBITS LDA,                           CLC, # 6 ADC,                CS IF,     # 1 ( CD-INIT continued      < 2/25/85>201) \ 3 screens preceding                                                                       XSAVE STX,                              X' CHX LDA, CLC,                           X' CBITS ADC,                           X       X' RIGHT.MSK STA,                    XSAVE LDX,                  EXIT --> ( 1 more screen )                                                                                     (  RLP )                                                                                                                                                                                                                                                        (  RLP )                                                                          ELSE,   X' &FOO LDA, X' &FOO 1+ LDY,    THEN,      # 7 LDX,                                X' $B/MOD JSR,                          &QUO LDA, X' RIGHT.D7 STA,              &REM LDY,                                  RMASKS ,Y LDA,                           EXIT ( 3 more screens )                                                                                                                                                                                                                                  CLC,                               X' &FOO ADC, X' &FOO STA,               X' &FOO 1+ LDA, # 0 ADC,                   X' &FOO 1+ STA,                      # 1 CMP,                     CS IF,  X' &FOO LDA, # 24 CMP, THEN,    CS IF,     # 23 LDA, # 1 LDY,  B/MOD JSR,                       &QUO LDA, X' LEFT.D7 STA,               &REM LDY, X' CPIX STY,                     LMASKS ,Y LDA,                          X' LEFT.MSK STA,                     XSAVE LDX,                                                     ( CD-INIT continued      < 2/25/85>202) \ 4 screens preceding                                                                       XSAVE STX,                              ' CDELX LDY, DEY,            0< IF,     # 0 LDY,                     THEN,      TYA,    XSAVE LDX,                              NEXT JMP, C;                EXIT                                                                                                           (  RLP )                                                                 ( CDRAW                  < 2/25/85>204)                                         : CDRAW ( addr x y -- )                          CD-INIT                                 X' $CDRAW CALL ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (  RLP )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     C@ CDELX + GX +!                  THEN THEN DROP ;                                                                                                     EXIT                                    --------------------------------------  does not                                                                                                                                                                                                                                                                 y ) GX @ GY @ ;                                                : <GEMIT> ( CH -- )                        DUP 128 <                               IF DUP >COFFSET @                          IF DUP >CDATA                              DUP @CURSOR CDRAW                                                                                                                                                                                                                                                                      ( <GEMIT>                < 2/25/85>211)                                         VARIABLE GX      ( current char )       VARIABLE GY      ( position )                                                   : !CURSOR ( x y -- ) GY ! GX ! ;        : @CURSOR ( -- x                                                                                                                                                                                                                                                                                                                                                                                                                                                       (  RLP )                                                        ( 17:13)                                                                                                                                                                                                                                                                         ' WIDTH !                                                                       : >COFFSET 2* ASCTAB + ;                : >CDATA >COFFSET @ ASCTAB + 270 + ;                                            EXIT                                                                                                                                                                                                                                                                                                             loaded into ASCTAB "   CR CR 2BEEP                                                                                                             WIDTH 5 ' WIDTH !                          ASCTAB 262 + @ CONSTANT CMAXX           ASCTAB 258 + @ CONSTANT CMAXY                                                                                                                                                                                                                                                                ( ASCTAB                 < 2/25/85>210)                                         : GTASK ;                                                                       CREATE ASCTAB  1624 ALLOT                                                       CR CR ." No font recognize carriage return,     line feed, back space, etc.             clips at right and bottom of screen                                                                            (  RLP )   -->                                                           ( MARGINS !CURSOR        < 2/25/85>212)                                         : GETMODE GMODE C@ ;                                                            VARIABLE LMARG    0  LMARG !            VARIABLE RMARG  279  RMARG !            VARIABLE TMARG                                                                                                                                                                                         (  RLP )                                                                               ELSE BEEP THEN                          R> SETMODE ;                                                              : GPUTC ( addr pos ch -- addr pos )           DUP <GEMIT>                             3 PICK 3 PICK + C! 1+ ;                                                                   EXIT                                                                                                                                                                                                                                             BL ROT C!                               DUP >CDATA C@ CDELX +                      NEGATE GX +!                            GX @ >R                              <GEMIT>                                    R> GX !              2 SETMODE                       LMARG @ RMARG @ SETENDPTS               TMARG @ BMARG @ VBAR                    SETMODE ;                                                              : GPAGE  GHOME CLW ;                                                    ( <GBK> GPUTC            < 2/25/85>215)                                         : <GBK> ( addr pos ch -- addr pos )           GETMODE >R 2 SETMODE                    DROP DUP 0>                             IF 1- DDUP +                               DUP C@ ( GHOME GPAGE CLW        < 2/25/85>213)                                         : GHOME  LMARG @ TMARG @ !CURSOR ;                                              ( clear window )                                                                : CLW    GETMODE                                                                                                                                                                                       (  RLP )                                                                                                                                                                                                                                                        (  RLP )   -->                                                                                                           : GKEY ( -- ch )                           BEGIN GCUR QTERM UNTIL <KEY> ;                                                                                       EXIT                                                    : !WINDOW ( x1 y1 x2 y2 -- )                  !XY2 !XY1 ;                                                                                                       EXIT                                                                                    TA                               DUP @CURSOR CDRAW  KDELAY               DUP @CURSOR CDRAW  KDELAY               DROP SETMODE ;                                                         : GCR    LMARG @ GX !                            CMAXY CDELY + GY +! ;    0  TMARG !            VARIABLE BMARG  191  BMARG !                                                    : !XY1 ( x1 y1 -- ) TMARG ! LMARG ! ;                                           : !XY2 ( x2 y2 -- ) BMARG ! RMARG ! ;                                   ( GCR GKEY               < 2/25/85>214)                                         : KDELAY                                   400 0 DO QTERM IF LEAVE THEN LOOP ;                                          :  GCUR  GETMODE 0 SETMODE                       BL >CDA                                                                        EXIT                                                                                                           (  RLP )                                                                 ( GCTRL GBLANK           < 2/25/85>216)                                         VARIABLE ?ESCAPE                                                                : GCTRL ( addr pos ch -- addr pos )           DROP BEEP ;                                                                       EXIT                                                                                                                                                   (  RLP )                                                                               ELSE DUP ASCII 0 - DUP 10 U<              IF GVAL @ 10 * +  DUP I' >                IF DROP GCTRL                           ELSE GVAL ! GPUTC THEN              ELSE DROP GCTRL THEN THEN THEN         REPEAT GVAL @ I <                      WHIL                 DUP BL =                                   IF GBLANK ELSE                             GPUTC                             THEN THEN THEN THEN                  REPEAT ( ch ) DROP                     R> DROP DDROP ;                             BL FILL 0 GVAL !         0 BEGIN                                    BEGIN GKEY DUP 13 = NOT                 WHILE                                    DUP 8 = OVER 127 = OR                     IF <GBK> GVAL @ 10 / GVAL !           ELSE OVER J < NOT IF GCTRL                                 DUP 8 = OVER 127 = OR                      IF <GBK>  ELSE                       DUP BL <                                   IF GCTRL  ELSE                       OVER R@ < NOT                              IF GCTRL  ELSE      ( GETN                   < 2/24/85>219) VARIABLE GVAL                                                                   : GETN ( min max addr count -- val )      >R SWAP >R SWAP >R CR                   ( I = min I' = max J = count )          ( addr ) DUP J( GEXPECT                < 2/25/85>217)                                         : GEXPECT ( addr count -- )                DDUP BL FILL ( count ) >R               0  BEGIN                                      GKEY ?GDONE NOT                      WHILE      GHOME                                   26 0 DO I 65 + GEMIT LOOP ;                                                                                                                   (  RLP )                                                                                                 EXIT                                                                                                                                                   (  RLP )                                                                         : TEST   PAGE 0 20 XYTAB ." TEST: "              1HG                                     PAD 12 GINPUT                           PAD COUNT TYPE                          SPACE PAD COUNT . DROP ;       : TEST2  0 0 279 191 !WINDOW GPAGE                      \ Return or Escape is pressed                                                   : ?GDONE ( addr pos ch -- addr pos ch )       DUP 27 = ?ESCAPE !                      DUP 27 = OVER 13 = OR ;                                                           AP -TRAILING                  ROT C! DROP ;                                                                                                     EXIT                                    --------------------------------------                                                          : GBLANK ( addr pos ch -- addr pos )          OVER 0>                                 IF GPUTC ELSE GCTRL THEN ;                                                                                        \ GEXPECT is done when either   ( GINPUT TEST            < 2/25/85>218)                                         : GEMIT <GEMIT> ;                                                               : GINPUT ( addr count -- )                    OVER 1+ OVER GEXPECT                    OVER 1+ SWE ( 13 ) GCTRL                      REPEAT R> R> R> DDROP DDROP DDROP     GVAL @ ;                                                                      EXIT                           (  RLP )                                                                 ( XBLOCK                 < 2/25/85>220)                                         \ draw a block big enough               \ to center a character                                                         : XBLOCK ( -- )                            GX @ CMAXX OV                                                                                                                                                                                       (  RLP )   -->                                                                   : 3GTYPE ( 1st letter inverse )            3 SETMODE                                  OVER C@ XEMIT                        5 SETMODE                                  SWAP 1+ SWAP 1- <GTYPE> ;                                                 : GTYPE            R> SETMODE ;                                                                                                         EXIT                                                                                                                                                    : 1GTYPE ( print normal )                  5 SETMODE <GTYPE> ;                                                          : 2GTYPE ( print inverse )                 3 SETMODE <GTYPE> 5 SETMODE ;                                                                   GX @ >R                                 1 SETMODE XBLOCK                        CMAXX CDELX + 1-                           OVER >CDATA C@ - 2/ GX +!            3 SETMODE <GEMIT>                       R> CMAXX + CDELX + 1+ GX !   ( GTYPE                  < 2/25/85>223)                                         : <GTYPE> ( addr count -- )                ?DUP IF                                    0 DO DUP I + C@ GEMIT LOOP           THEN DROP ;                                          ( XEMIT                  < 2/25/85>221)                                         \ print character in inverse            \ and center it in a block                                                      : XEMIT ( ch -- )                          GETMODE >R                                                                                                                                                                                          (  RLP )   -->                                                                                                                                                                                                                                                  (  RLP )   -->                                                           LAY              QTERM                             UNTIL DDROP                             R> SETMODE <KEY> ;                                                                                                   EXIT                                                                                                                                                                                                                                                                                                                                       GETMODE >R                              0 SETMODE                               @CURSOR                                 BEGIN                                         DDUP !CURSOR XBLOCK KDELAY              DDUP !CURSOR XBLOCK KDEER + CDELX + 1-               SETENDPTS                            GY @ CMAXY OVER + CDELY + 1-               VBAR ;                                                                    EXIT                                                                    ( XKEY                   < 2/25/85>222)                                         \ Assume character has been drawn       \ by "XEMIT" at [GX,GY].                \ Flash box until a key is pressed.                                             : XKEY ( -- ch )<GTYPE> ;                                                               EXIT                                                                                                           (  RLP )                                                                 ( G. GTAB                < 2/25/85>224)                                         \ Print number on graphics screen.      \ Does not check for stack underflow.                                           : G. ( n dp -- )                           >R 0         T                                                                                                                                                                                      (  RLP )                                                                                                                                                                                                                                                                                                                                 HEN           34 WORD DUP C@ 1+                       OVER + C@ 34 = NOT ?STREAM              STATE @ IF C@ 1+ ALLOT                     ELSE COUNT GTYPE THEN             THEN ; IMMEDIATE                                                             MAIN EXI                                                                                                                                                                                                                                                                                                                                : G."                                      'STREAM C@ 34 =                         IF 1 >IN +!                             ELSE                                       STATE @ IF COMPILE <G."> T                                                                                                                                                                                                                                                                ( G."                    < 2/25/85>225) MAIN                                                                            : <G.">                                    R@ COUNT DUP 1+ R> + >R GTYPE ;                                              APPENDIX                                                                                                                                                                                                                                                                                                                                                                                                                                                               (  RLP )                                                                                                                                                                                                                                                                                                                                         \ "8" has been arbitrarily chosen.                                              : GTAB ( n -- )                            8 * GX @ + 0 MAX 279 MIN GX ! ;                                              EXIT                                                                                                                                                                                                                                                                                                                                       <# R> ?DUP                                 IF 0 DO # LOOP 46 HOLD THEN          #S #> GTYPE ;                                                                                                        \ Tab over "n" char positions.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      PLA, TAY, PLA, TAX, PLA,                RTS, XC;                                                            EXIT                                    --------------------------------------  Note: will wrap around                        if                                                                                                                                                                                                                                                                IGHT.D7 INC,                        # 0 LDY,                     ELSE,      INY,                         THEN,                                              RMASKS ,Y LDA,                          X' RIGHT.MSK STA,                       X' $HLINE JSR,                                                                                                                                                                                                                                                                      ( $HPLOT CONTINUED       < 2/25/85>231)                                                     &REM LDY,                               LMASKS ,Y LDA,                          X' LEFT.MSK  STA,                       # 6 CPY,                     CS IF,     X' R                                                                                                                                                                                                                                                                ore ... )                                                                                                                                                                              (  RLP )                                                                                                                                                                                                                                                                                                                                                     X' $7/MOD JSR,                          X' $YADDR JSR,                          &QUO LDA,                               X' LEFT.D7 STA,                         X' RIGHT.D7 STA,                                                    EXIT ( m                                                                                                                                                                                                                                                                                                    # 192 CPX,                    CS IF,    RTS,                          THEN,                                             N STA,                                  PHA, TXA, PHA, TYA, PHA,                N LDA,                                                                                                                                                                                                                                                                              ( $HPLOT                 < 2/25/85>230) \ plot point at {x,y}                   \ entry: "X" = y coord                  \ "A" = x coord lsb "Y" = x coord msb                                                                                   XCODE $HPLOT     plotting at x = 279                                                                                                                                                                   (  RLP )                                                                 ( HPLOT                  < 2/25/85>232)                                         CODE HPLOT ( x y -- )                            XSAVE STX,                              SEC    LDA, PHA,    ( xlo )             SEC 1+ LDA, TAY,    ( xhi )             BOT                                                                                                                                                                                                                                                                            VARIABLE DELP                           VARIABLE LERR                                                                   VARIABLE DCNT                                                                   EXIT                                                                                                                                                                                                                                                                                                              VARIABLE LYTEM                                                VARIABLE DELSX    VARIABLE DELDX        VARIABLE DELSY    VARIABLE DELDY        VARIABLE DELSE    VARIABLE DELDE                                                VARIABLE DELS                                                                                                                                                                                                                                                                                   ( LINE -- HIGH LEVEL     < 2/25/85>235)                                         WIDTH 5 MAX ' WIDTH !                                                           VARIABLE LX1      VARIABLE LY1          VARIABLE LX2      VARIABLE LY2          VARIABLE LXTEM                                                                                                                                                                                                                                                                                                  EXIT                                                                                                                                                   (  RLP )                                                                                                                                                                                                                                                        (  RLP )                                                                         : <DOT>                                    DOTX @ 279 U< DOTY @ 192 U<             AND IF <1PLOT> THEN ;                                                        : DOT ( x y -- )                           DOTY ! DOTX ! <DOT> ;                                --------------------------------------                                                                                                                                                                                                                  TX,                              DOTX     LDA, ( x lsb )                 DOTX  1+ LDY, ( x msb )                 DOTY     LDX, ( y lsb )                 X' $HPLOT JSR,                          XSAVE LDX, NEXT JMP, C;                                        LDA, TAX,    ( ylo )             PLA,                                    X' $HPLOT JSR,                          XSAVE LDX,                              POPTWO JMP, C;                                                         EXIT                            ( $DOT -- REVECTORABLE   < 2/25/85>234) VARIABLE DOTX                           VARIABLE DOTY                           \ VARIABLE DOTSUBR                                                              CODE <1PLOT>                                     XSAVE S                                                                                                                                                                                       (  RLP )                                                                 ( $BRES                  < 2/25/85>236) EXIT                                    --------------------------------------- \ code version                                                                  CODE $STRAIGHT                                      DELS    DOTY  1+ ADC, DOTY  1+ STA,                                                     RTS,                        END-CODE                                                               (  RLP )                                                                             0= IF,  DCNT 1+  DEC,                   THEN,   DCNT     DEC,                           DCNT 1+  LDA,                0< UNTIL,  RTS,                        END-CODE                                                                                   STA,             DELDX 1+ LDA,                           DOTX  1+ ADC, DOTX  1+ STA,                                                     DELDY    LDA, CLC,                      DOTY     ADC, DOTY     STA,             DELDY 1+ LDA,                       OT   JSR,                                                                   LERR 1+  LDA,                   0< IF,  ' $STRAIGHT JSR,                ELSE,   ' $DIAGONAL JSR,                THEN,                                           DCNT     LDA,       E    LDA, CLC,                      LERR     ADC, LERR     STA,             DELDE 1+ LDA,                           LERR 1+  ADC, LERR 1+  STA,                                                     DELDX    LDA, CLC,                      DOTX     ADC, DOTX  ( $BRES cnt'd   <BRES>   < 2/25/85>239) EXIT                                    --------------------------------------- \ code version continued                                                         BEGIN,                                             ' $D( $BRES CONTINUED        < 2/25/85>237) EXIT                                    --------------------------------------- \ code version                                                                  CODE $DIAGONAL                                      DELDre ... )                                                                                                                                                                               (  RLP )                                                                     DOTY  1+ ADC, DOTY  1+ STA,                                                     RTS,                        END-CODE                                                               (  RLP )                                                                  STA,               DELS 1+ LDA, DCNT 1+ STA,                                                       DCNT    INC,                 0= IF,     DCNT 1+ INC,                 THEN,                                                                          --> ( mo   STA,             DELSX 1+ LDA,                           DOTX  1+ ADC, DOTX  1+ STA,                                                     DELSY    LDA, CLC,                      DOTY     ADC, DOTY     STA,             DELSY 1+ LDA,                                                           LX1     LDA, DOTX    STA,               LX1 1+  LDA, DOTX 1+ STA,               LY1     LDA, DOTY    STA,               LY1 1+  LDA, DOTY 1+ STA,                                                       DELS    LDA, DCNT   E    LDA, CLC,                      LERR     ADC, LERR     STA,             DELSE 1+ LDA,                           LERR 1+  ADC, LERR 1+  STA,                                                     DELSX    LDA, CLC,                      DOTX     ADC, DOTX  ( $BRES continued        < 2/25/85>238) EXIT                                    --------------------------------------- \ code version                          \ registers are *NOT* preserved                                                 CODE $BRES                                      : <BRES>  ' $BRES CALL ;                                                                                                                               (  RLP )                                                                 ( BRES high level version< 2/25/85>240)                                         : BRES ( -- )                               LX1 @ DOTX !                            LY1 @ DOTY !                            DELS @ 1+ 0 DO                              <DOT>   LS @ -      DELDE !                   BRES ;                            EXIT                                                                                                           (  RLP )                                                                                                                                                                                                                                                                                                                                  DELP !             0 DELSX ! DELDY @ DELSY !         ELSE  0 DELSY ! DELDX @ DELSX !         THEN                                                                            DELP @ 2* DUP DELSE !                   DELS @ -  DUP LERR  !                   DE                                                                                                                                                                                                                                                                                              LX2 @ LX1 @ -                           DUP 0< IF ABS -1 ELSE 1 THEN            DELDX ! DELS !                                                                  DELS @ DELP @ <                         IF    DELS @ DELP @ DELS !                                                                                                                                                                                                                                                                ( BRESENHAM'S ALGORITHM  < 2/25/85>241)                                         : BRESENHAM ( -- )                            LY2 @ LY1 @ -                           DUP 0< IF ABS -1 ELSE 1 THEN            DELDY ! DELP !                                                                                                                                                                                                                           (  RLP )                                                                                                                                                                                                                                                        (  RLP )                                                                                                                                                                                                                                                                                                                                                        DELDX @ DOTX +!                         DELDY @ DOTY +!                  THEN                                LOOP ;                                                                      EXIT                                            BRESENHAM ;                                                     EXIT                                    --------------------------------------  RELINE draws a line using the end       points of the previous line.                                                                            LERR @ 0< IF                                   DELSE @ LERR +!                         DELSX @ DOTX +!                         DELSY @ DOTY +!                  ELSE                                           DELDE @ LERR +!  ( LINE                   < 2/25/85>242)                                         : LINE ( X1 Y1 X2 Y2 -- )                     LY2 ! LX2 ! LY1 ! LX1 !                 BRESENHAM ;                                                               : RELINE ( -- )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                             YDELTA +                     DO    I YADDR GPATTERN !                      I YDELTA - HLINEB                 LOOP                                 2 SETMODE ( black )                        DUP 1+ YDELTA - SWAP VLINE           R> SETMODE ;                                                                                                                                                                                                                                                                                 ( SCUP                   < 2/25/85>251)                                         : SCUP ( win -- )                          SCRL-PARM ( top bottom )                GMODE C@ >R                             5 SETMODE                                  DUP 1+ ROT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ( G."                    < 2/24/85>250)                                         : <G.">                                    R@ COUNT DUP 1+ R> + >R GTYPE ;                                                                                                                                                                                                                                                                                             (  RLP )                                                                 ( SCDN                   < 2/25/85>252)                                         : SCDN ( win -- )                          SCRL-PARM ( top bottom )                GMODE C@ >R                             5 SETMODE                                  YDELTA - O                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (  RLP )                                                                                                                                                                                                                                                                                                                                                                                 EXIT                                                                                                                                                                                                                                                                                                                                                                                                                                                                            VER 1- SWAP                   DO    I YADDR GPATTERN !                      I YDELTA + HLINEB                 -1 +LOOP                             2 SETMODE ( black )                        DUP YDELTA + VLINE                   R> SETMODE ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ( INCLR                  < 3/10/85>260)                                         : TASK ;                                                                        : <INCLR>                                   R> DUP 1+ >R C@ HCOLOR ;                                                                                                                                                                                                                   (  RLP )                                                                                                                                                                                                                                                                                                                                             ; IMMEDIATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     BL WORD NUMBER DROP                     BL WORD NUMBER DROP                     STATE @                                 IF  280 * +                                 COMPILE <INXY> ,                    ELSE !CURSOR THEN                                                                                                                                                                                                                                                                           ( INXY                   < 3/10/85>261)                                         : <INXY>                                    R> DUP 2+ >R @                          280 /MOD !CURSOR ;                                                          : INXY                                                                                                                                                                                                                                                                                                                                                                                                                                                                 (  RLP )                                                                             STATE @                                 IF  COMPILE <INBAR> DSWAP                   280 * + ,                               280 * + ,                           ELSE BAR THEN                           ; IMMEDIATE                                                                                                                                                                                                                                                                                                                                                                 : INBAR                                     BL WORD NUMBER DROP                     BL WORD NUMBER DROP                     BL WORD NUMBER DROP                     BL WORD NUMBER DROP                                 : INCLR                                     BL WORD NUMBER DROP                     STATE @                                 IF COMPILE <INCLR> C,                   ELSE HCOLOR THEN                        ; IMMEDIATE                 ( INBAR                  < 3/10/85>262)                                         : <INBAR>                                   R> DUP 4 + >R                           DUP    @ 280 /MOD                       ROT 2+ @ 280 /MOD                       BAR ;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  278 BLOCK OVER        1024 CMOVE        279 BLOCK OVER 1024 +  600 CMOVE        DROP ;                                                                                                                                                                                                                                                                                                                                                                                                                               TAB 1024 +  600 CMOVE                                           EXIT                                                                                                                    : SCARSDALEF                               ASCTAB                                                                                                                                                                                                                                                                                       ( LOAD BRODY FONT        < 2/25/85>275)                                         CR CR ." LOADING BRODY FONT " 2BEEP     CR CR 2BEEP                                                                        276 BLOCK ASCTAB        1024 CMOVE      277 BLOCK ASC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                U]U]U]www3;www3	               
     % 1 = R g                                                           	!-9EQ]r~&2GS_kw.:FR^s            	!-9EZfr~#  *HkQ=-QGETMQAQLMAR  RRMARRTMAR  RBMAR 'R!XYQ#RR3R!XYQ/RRFR!WINQMR:RYRGHOMQR#RQiRCLQQ6DRRE#R/RF6DRGPAGQqRRRKDELQ,
 	!	RGCUQQ6D                                                                                                                                                                                                                                                                	  ??  	  	  	  		s              _		p ~c~  JCMAXr  =QCMAXr  IQ>COFQJkUQ>CDAQ]QJk,kgQG~ QG  Q!CURQQQQ@CURQQQQ<GEMQ5,   5]Q 5oQ5QJ    	                 	         	                                                                                                                                                                                                                           	<?   	  nscsn`> 	;gccc   	    	  	33   	   
	    O3333    _	  3333  	  333  	  ;gcg;	  nscsn``	    	  >0  	?  	  3333>  	  cc66  
	    3333N    _	  33  	  33  	    	  	   	  	   	  			  	  	    	  				  	    	   	   	    	    	  	    	  
  	  
  	  

  	   	    	     O[scC    _	6ccc6  	333  	 6 c c s v \    _	3333   	303   	?   	333333   	CCf f < <      _		;oG    _	3333  	CCf <        _	?0?   	  nscsn   	;gcg;   	  33   	``nscsn   	  >c?~   	  	  	  	  		  		  	  	  	  	
  	  	

  	
  	  	         	         	  	  
    	        	      	    	  	    	   	       	     	        	     	30    	|3[[6    _	66c  	3333  	66  	33333  	  	  	6csf<  	333?333  	  	  	33  	  		Go;    _	CG  	  	  	  	  	       	     	  	       	  	   	  	
  	  	  	  	  	  	  	  	  	  			  	  3 s ^    _	        	   	   	 3?3    	 ?    	        	         	         	@` 0         _	33333   	   	308?   	3003   	 08<60   	?303   	833   	0   	3333   	33>   	       	            	         	   	      	 




 	   	  		  	      	  	  	  	    	      	        	        	    	  	  	  	  	
	  	8	             	UUUUUUU  		p ~c~     	?  	?  		  @ @@@      	           	    Cco0 C3 6 _c       	         o	   o	       o		l l l l l     _	 ~ [ x [~    _
	[n 0 XlF    _	 6 <  ANLQT"72)                          472                            # . 9 D O Z e p {             
 +6ALWbmx(3>IT_ju%0;FQ\gr}                                                                                                                                                                                                                                                                